#include <stdio.h>
#include <stdlib.h>
#include <time.h>

void play_game() {
    int winning_number;
    int guess;
    int score = 100;
    int low = 1;
    int high = 100;

    winning_number = rand() % 100 + 1;

    printf("(Score=%d)\n", score);

    do {
        printf("Guess the winning number (%d-%d) : ", low, high);

        if (scanf("%d", &guess) != 1) {
            printf("Invalid input. Please enter a number.\n");
            while (getchar() != '\n'); 
            continue;
        }

        if (guess == winning_number) {
            printf("That is correct! The winning number is %d.\n", winning_number);
            printf("Score this game: %d\n", score);
            break; 
        } else {
            score -= 10; 
            if (score <= 0) {
                score = 0; 
                printf("Sorry, your score is 0. Game Over! The winning number was %d.\n", winning_number);
                break; 
            }

            if (guess < winning_number) {
                printf("Sorry, the winning number is HIGHER than %d. (Score=%d)\n", guess, score);
                if (guess >= low && guess < high) {
                     low = guess + 1;
                }
            } else { 
                printf("Sorry, the winning number is LOWER than %d. (Score=%d)\n", guess, score);
                 if (guess <= high && guess > low) { 
                     high = guess - 1;
                }
            }
        }
    } while (1); 
}
int main() {
    int choice;
    srand(time(NULL));
    do {
        printf("Do you want to play game (1=play, -1=exit) : ");
        if (scanf("%d", &choice) != 1) {
            char input_buffer[100]; // บัฟเฟอร์สำหรับเก็บค่าที่ไม่ถูกต้อง
            if (scanf("%s", input_buffer) == 1) {
                printf("Please enter only 1 or -1.\n");
                while (getchar() != '\n'); 
                continue; 
            } else {
                while (getchar() != '\n');
                continue;
            }
        }
        if (choice == 1) {
            play_game(); 
        } else if (choice != -1) {
            printf("Please enter only 1 or -1.\n");
        }
    } while (choice != -1);
    printf("See you again.\n");
    return 0;
}
